<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pygame Space Shooter</title>
    <!-- This loads the Pyodide (Python in browser) engine -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.1/full/pyodide.js"></script>
    
    <style>
        /* Base styling for the whole page */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #111;
            color: #eee;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        h1 {
            color: #4a90e2;
        }
        /* This is the black box where your Pygame will appear */
        #pygame-canvas-container {
            /* Set this size to match your Pygame window's size (e.g., 800x600) */
            width: 800px; 
            height: 600px;
            border: 2px solid #555;
            border-radius: 8px;
            overflow: hidden;
            background-color: #000;
        }
        #loading-message {
            font-size: 1.2rem;
            padding: 20px;
            text-align: center;
            color: #999;
        }
    </style>
</head>
<body>
    <h1>Matthew's Space Shooter</h1>

    <!-- The game will appear inside this div -->
    <div id="pygame-canvas-container">
        <!-- A message to show while the game is loading -->
        <div id="loading-message">
            Loading Python assets...<br>
            This may take 15-30 seconds on the first load.
        </div>
    </div>
    
    <script type="text/javascript">
        // This is the main JavaScript code to run your game
        async function runPygame() {
            const loadingMessage = document.getElementById('loading-message');
            
            try {
                // 1. Load the Pyodide engine
                loadingMessage.innerText += "\nLoading Pyodide (Python interpreter)...";
                const pyodide = await loadPyodide();
                
                // 2. Load the 'pygame-web' package directly (This is the fix)
                // We use pyodide.loadPackage to bypass the problematic micropip installer.
                loadingMessage.innerText += "\nLoading pygame-web library directly...";
                await pyodide.loadPackage("pygame-web");
                
                // 3. Fetch your Python game file (space_shooter.py)
                loadingMessage.innerText += "\nFetching space_shooter.py...";
                const response = await fetch('space_shooter.py');
                if (!response.ok) {
                    throw new Error(`Failed to fetch space_shooter.py: ${response.statusText}. Did you commit space_shooter.py?`);
                }
                const pythonCode = await response.text();
                
                // 4. Run the game!
                loadingMessage.innerText = "Starting game...";
                
                // This tells Pygame to use the div#pygame-canvas-container
                pyodide.globals.set("PYGAME_CANVAS_ID", "pygame-canvas-container");
                
                await pyodide.runPythonAsync(pythonCode);
                
                // 5. Hide the loading message once the game starts
                loadingMessage.style.display = 'none';

            } catch (err) {
                // If something goes wrong, show the error
                loadingMessage.innerText = `FATAL ERROR:\n${err.message}`;
                console.error(err);
            }
        }
        
        // Start the game
        runPygame();
    </script>
</body>
</html><!--  -->